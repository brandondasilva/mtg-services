"use strict";function composeMail(){new helper.Content("text/html","")}function slackPost(a,b){request({url:b,method:"POST",json:!0,body:a})}var moment=require("moment-timezone"),express=require("express"),request=require("request"),router=express.Router(),helper=require("sendgrid").mail,sg=require("sendgrid")(process.env.SENDGRID_API_KEY),google=require("googleapis"),googleAuth=google.auth.OAuth2,sheets=google.sheets("v4");router.get("/",function(a,b){b.set("Access-Control-Allow-Origin","*"),b.send("API v1 GET: Hello World!")}),router.post("/",function(a,b){b.set("Access-Control-Allow-Origin","*");var c=(a.body.firstname+" "+a.body.lastname,new Date),d=(moment.tz(c,"America/Toronto").format(),new helper.Email("info@medtechgateway.com","Medical Technologies Gateway")),e=new helper.Email("brandon@bdsdesign.co"),f=new helper.Email(a.body.email,a.body.name),g="New contact form submission on the MTG website!",h="Medical Technologies Gateway - Contact Form Submission Confirmation",i=(composeMail(d,g,e,a.body,process.env.REGISTRATION_MTG_TEMPLATE),composeMail(d,h,f,a.body,process.env.REGISTRATION_USER_TEMPLATE),{attachments:[{fallback:"A new request for a quote has been submitted.",color:"#36a64f",pretext:"A new request for a quote has been submitted.",title:"New Form Quote Submission",text:"The following are the contents of the form for reference.",fields:[{title:"PAC Email Status code",value:"value","short":!0}]}]});slackPost(i,process.env.PREMUS_SLACK_WEBHOOK),slackPost(i,process.env.BDS_SLACK_WEBHOOK)}),module.exports=router;